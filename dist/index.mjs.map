{"version":3,"sources":["lib/observable.js","lib/array.js","lib/object.js","lib/proxy.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["const EventEmitter = require('events');\n\nclass ObservableEmitter extends EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\n    this.eventQueue = {};\n\t}\n\ton(event, listener) {\n\t\tsuper.on(event, listener)\n\n    let queue = this.eventQueue[event]\n\n    if(queue) {\n      queue.forEach((args) => {\n        this.emit(event, ...args)\n      })\n    }\n\n    return this;\n\t}\n\temit(event, ...args) {\n\t\tvar listeners = this._events[event];\n\n\t\tif(!listeners || listeners.length == 0) {\n\t\t\tlet queue = this.eventQueue[event];\n\n\t\t\tif(!queue) {\n\t\t\t\tqueue = this.eventQueue[event] = [];\n\t\t\t}\n\n      queue.push(args);\n\t\t} else {\n\t\t\tsuper.emit(event, ...args);\n\t\t}\n\t}\n}\n\nexport default ObservableEmitter;\n","import ObservableEmitter  from \"./observable.js\";\nconst proxyClass = require(\"@aboutweb/proxyclass\");\n\nclass ArrayEmitter extends proxyClass.hasInstance(Array, ObservableEmitter) {\n  constructor(...data) {\n    super();\n\n    if(data) {\n      this.push(...data);\n    }\n  }\n  push(...args) {\n    super.push(...args);\n    this.emit(\"push\", ...args);\n    this.emit(\"change$length\", this.length);\n    this.emit(\"change\", this);\n  }\n  pop() {\n    let elem = super.pop();\n\n    this.emit(\"pop\", elem);\n    this.emit(\"change$length\", this.length);\n    this.emit(\"change\", this);\n\n    return elem;\n  }\n  splice(...args) {\n    let elems = super.splice(...args);\n\n    this.emit(\"splice\", ...args);\n    this.emit(\"change$length\", this.length);\n    this.emit(\"change\", this);\n\n    return elems;\n  }\n  unshift(...args) {\n    super.unshift(...args);\n\n    this.emit(\"unshift\", ...args);\n    this.emit(\"change$length\", this.length);\n    this.emit(\"change\", this);\n  }\n  shift() {\n    let elem = super.shift();\n\n    this.emit(\"shift\");\n    this.emit(\"change$length\", this.length);\n    this.emit(\"change\", this);\n\n    return elem;\n  }\n\n  set(newValue) {\n    while(super.pop()) {}\n    super.push(...newValue);\n\n    this.emit(\"set\", this);\n    this.emit(\"change$length\", this.length);\n    this.emit(\"change\", this);\n  }\n  static get [Symbol.species]() { return Array; }\n}\n\nexport default ArrayEmitter;\n","import ObservableEmitter  from \"./observable.js\";\n\nclass ObjectEmitter extends ObservableEmitter {\n  constructor(data) {\n    super();\n\n    if(data) {\n      this.subscribe(data);\n    }\n  }\n  subscribe(data) {\n    Object.keys(data).forEach(function(key) {\n      let value = data[key];\n\n      Object.defineProperty(this, key, {\n        enumerable : true,\n        configurable : true,\n        get : function() {\n          return value;\n        },\n        set : (\n          value instanceof ObservableEmitter\n            ?function(newValue) {\n              value.set(newValue);\n              this.emit(\"change$\"+key, newValue);\n            }\n            :function(newValue) {\n              value = newValue;\n              this.emit(\"change$\"+key, newValue);\n            }\n        )\n      });\n    }, this);\n  }\n  unsubscribe(...keys) {\n    keys.forEach(function(key) {\n      delete this[key];\n    }, this);\n  }\n  set(newValue) {\n    this.unsubscribe(...Object.keys(this));\n    this.subscribe(newValue);\n    this.emit(\"set\", this);\n  }\n}\n\nexport default ObjectEmitter;\n","import ObservableEmitter  from \"./observable.js\";\n\nclass ObserableProxy extends ObservableEmitter {\n  constructor(data = {}) {\n    super();\n\n    let self = this;\n\n    //Object.assign(this, data);\n\n    /*Object.defineProperty(data, \"set\", {\n      value : function(value) {\n        Object.keys(this).map(function(prop) {\n          delete this[prop];\n        });\n\n        Object.assign(this, value);\n        this.emit(\"set\", this);\n      }\n    });*/\n    this.data = data;\n\n    return this.proxy = new Proxy(data, {\n      get(target, property) {\n        let value = self[property]\n\n        if(property in self) {\n          return self[property];\n        }\n\n        return data[property];\n      },\n      set(target, property, value) {\n        if(property in self) {\n          return Reflect.set(self, property, value);\n        }\n\n        let curr = target[property];\n\n        if(curr instanceof ObservableEmitter) {\n          curr.set(value);\n        } else {\n          Reflect.set(target, property, value);\n        }\n\n        self.emit(\"change$\"+property, value);\n        self.emit(\"change\", property, value);\n\n        return true;\n      },\n      defineProperty(target, property, descriptor) {\n        let curr = target[property];\n\n        Reflect.defineProperty(target, property, descriptor);\n\n        self.emit(\"change$\"+property, value);\n        self.emit(\"change\", prop, value);\n\n        return true;\n      },\n      deleteProperty(target, property) {\n        Reflect.deleteProperty(target, property);\n        self.emit(\"delete$\"+property)\n        self.emit(\"delete\", property);\n      }\n    })\n  }\n\n  set(value) {\n    Object.keys(this.data).forEach(function(property) {\n      if(!(property in value)) {\n        delete this.proxy[property];\n      }\n    });\n\n    Object.assign(this.proxy, value);\n    this.emit(\"set\", this.proxy);\n  }\n}\n\nexport default ObserableProxy;\n"]}